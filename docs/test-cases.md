# テストケース仕様書

## 概要

このドキュメントは、アウトラインエディタの機能を基に作成したテストケースを記載します。各機能ごとに包括的なテストを実施します。

## テストケース一覧

### 機能1: ノード管理

#### TC-FUNC-001: ノード追加機能
- **テスト名**: ノード追加機能の総合テスト
- **前提条件**: アプリケーションが起動している
- **テストステップ**:
  1. ブラウザでページを開く
  2. 「ルートノード追加」ボタンをクリック
  3. タイトル「テストノード」、作成者「TestUser」を入力
  4. ツリーに新しいノードが表示されることを確認
  5. ノードを選択して右ペインに詳細が表示されることを確認
  6. 子ノード追加ボタンをクリック
  7. 子ノードが作成され、親子関係が正しく表示されることを確認
- **期待結果**: ルートノードと子ノードが正常に作成され、UIに正しく反映される

#### TC-FUNC-002: ノード編集機能
- **テスト名**: ノード編集機能の総合テスト
- **前提条件**: ノードが存在する
- **テストステップ**:
  1. ノードを選択
  2. 右ペインでタイトルを「更新タイトル」に変更
  3. 内容を「更新内容」に変更
  4. 保存ボタンをクリック
  5. ツリーと右ペインに変更が反映されることを確認
- **期待結果**: ノード情報が正しく更新され、変更が永続化される

#### TC-FUNC-003: ノード削除機能
- **テスト名**: ノード削除機能の総合テスト
- **前提条件**: 削除対象のノードが存在する
- **テストステップ**:
  1. ノードを選択
  2. 削除ボタンをクリック
  3. 確認ダイアログでOKをクリック
  4. ノードがツリーから消え、右ペインがクリアされることを確認
- **期待結果**: ノードが完全に削除され、関連する親子関係も適切に処理される

### 機能2: ツリー表示とナビゲーション

#### TC-FUNC-004: ツリー表示機能
- **テスト名**: ツリー表示機能の総合テスト
- **前提条件**: 複数のノードが存在する
- **テストステップ**:
  1. ページを読み込み
  2. 左ペインに階層構造のツリーが表示されることを確認
  3. 展開/折りたたみアイコンをクリック
  4. 子ノードの表示/非表示が切り替わることを確認
  5. ノードクリックで右ペインが更新されることを確認
  6. ツリーモード切り替えタブをクリックして「逆ツリー」モードに変更
  7. ツリーが逆方向（子から親へ）の構造で表示されることを確認
  8. 逆ツリーでもノード選択と右ペイン更新が正常に動作することを確認
  9. 通常モードに戻して表示が切り替わることを確認
- **期待結果**: ツリー構造が正しく表示され、通常/逆ツリー両方の操作が正常に動作する

#### TC-FUNC-005: ツリー展開/折りたたみ
- **テスト名**: ツリー展開/折りたたみ機能のテスト
- **前提条件**: 子ノードを持つ親ノードが存在する
- **テストステップ**:
  1. 親ノードの展開アイコンをクリック
  2. 子ノードが表示されることを確認
  3. 折りたたみアイコンをクリック
  4. 子ノードが非表示になることを確認
  5. 展開状態が維持されることを確認
- **期待結果**: 展開/折りたたみが正しく動作し、状態が維持される

### 機能3: 検索機能

#### TC-FUNC-006: 検索機能
- **テスト名**: 検索機能の総合テスト
- **前提条件**: 検索対象のノードが存在する
- **テストステップ**:
  1. 検索バーにキーワードを入力
  2. リアルタイムで検索結果が表示されることを確認
  3. 該当ノードがハイライトされることを確認
  4. 検索結果のノードをクリック
  5. 右ペインに詳細が表示されることを確認
  6. クリアボタンで検索がリセットされることを確認
- **期待結果**: 検索が正常に動作し、結果が正しく表示される

### 機能4: キーボード操作

#### TC-FUNC-007: キーボードナビゲーション
- **テスト名**: キーボードナビゲーション機能の総合テスト
- **前提条件**: 複数のノードが存在する
- **テストステップ**:
  1. ノードを選択
  2. 右キーを押して展開を確認
  3. 左キーを押して折りたたみを確認
  4. 下キーを押して次のノードに移動を確認
  5. 上キーを押して前のノードに移動を確認
  6. 最上/最下ノードでの境界動作を確認
- **期待結果**: すべてのキーボード操作が正しく動作する

### 機能5: ドラッグ&ドロップ

#### TC-FUNC-008: ドラッグ&ドロップ並び替え
- **テスト名**: ドラッグ&ドロップ並び替え機能のテスト
- **前提条件**: 複数のノードが存在する
- **テストステップ**:
  1. ノードをドラッグ
  2. 別の位置にドロップ
  3. ノードの順序が変更されることを確認
  4. ページをリロードしても順序が維持されることを確認
- **期待結果**: 並び替えが正常に動作し、変更が保存される

### 機能6: データ永続性

#### TC-FUNC-009: データ永続性テスト
- **テスト名**: データの永続性確認
- **前提条件**: ノードが作成されている
- **テストステップ**:
  1. ノードを作成・編集
  2. ページをリロード
  3. データが保持されていることを確認
  4. ブラウザを閉じて再度開く
  5. データが保持されていることを確認
- **期待結果**: すべてのデータが正しく永続化される

### 機能7: 親ノード表示

#### TC-FUNC-010: 親ノード表示（単一親）
- **テスト名**: 単一親ノードの表示確認
- **前提条件**: アプリケーションが起動している
- **テストステップ**:
  1. ルートノード「親A」を作成
  2. ルートノード「子X」を作成
  3. 「子X」をコピー（Ctrl+C）
  4. 「親A」を選択してペースト（Ctrl+V）
  5. 「子X」を選択
  6. 右ペインに「親ノード (1)」が表示されることを確認
  7. 親ノードリストに「親A」が紫色で表示されることを確認
  8. 削除ボタンが1つ表示されることを確認
- **期待結果**: 単一の親ノードが正しく表示される

#### TC-FUNC-011: 親ノード表示（複数親）
- **テスト名**: 複数親ノードの表示確認
- **前提条件**: アプリケーションが起動している
- **テストステップ**:
  1. ルートノード「親A」「親B」「子X」を作成
  2. 「子X」を「親A」の子として追加（コピー&ペースト）
  3. 「子X」を「親B」の子として追加（コピー&ペースト）
  4. 「子X」を選択
  5. 右ペインに「親ノード (2)」が表示されることを確認
  6. 親ノードリストに「親A」と「親B」が紫色で表示されることを確認
  7. 各親に削除ボタンが表示されることを確認
- **期待結果**: 複数の親ノードが正しく表示される

#### TC-FUNC-012: 親削除機能
- **テスト名**: 親ノード削除機能の確認
- **前提条件**: アプリケーションが起動している
- **テストステップ**:
  1. ルートノード「親1」「親2」「子」を作成
  2. 「子」を「親1」と「親2」の子として追加
  3. 「子」を選択し、「親ノード (2)」が表示されることを確認
  4. 1つ目の親の削除ボタンをクリック
  5. 「親ノード (1)」に変更されることを確認
  6. 削除ボタンが1つだけ表示されることを確認
- **期待結果**: 親ノードの削除が正しく動作する

#### TC-FUNC-013: 最後の親削除（ルートノード化）
- **テスト名**: 最後の親を削除するとルートノードになることの確認
- **前提条件**: アプリケーションが起動している
- **テストステップ**:
  1. ルートノード「親」「子」を作成
  2. 「子」を「親」の子として追加
  3. 「子」を選択し、「親ノード (1)」が表示されることを確認
  4. 親の削除ボタンをクリック
  5. 「親ノード」セクションが表示されなくなることを確認
  6. 「子」がルートノードとして左ペインに表示されることを確認
- **期待結果**: 最後の親を削除すると、子がルートノードになる

## テスト環境

- **テストツール**: Playwright (自動テスト)
- **ブラウザ**: Chromium (headed mode)
- **テストデータ**: 各テスト前に自動クリア (`DELETE /api/test/clear`)
- **環境**: ローカル開発環境 (npm run dev:sandbox)
- **実行コマンド**: `npx playwright test`

## 優先度

- 高: ノード管理、ツリー表示
- 中: 検索、キーボード操作
- 低: ドラッグ&ドロップ、データ永続性

## テスト完了基準

- 全機能レベルのテストケースがPass
- UI操作がスムーズに動作
- データの整合性が保たれる
- エラーハンドリングが適切