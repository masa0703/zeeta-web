# 画面定義書

## 概要

アウトラインエディタのユーザーインターフェースの定義を記載します。画面は2ペイン構成で、左側にツリー表示、右側に詳細編集エリアを配置しています。

## 全体レイアウト

```
┌─────────────────────────────────────────────────┐
│ ヘッダー（バージョン情報）                      │
├─────────────────┬───────────────────────────────┤
│ ツリー表示      │ 詳細編集                      │
│ （左ペイン）    │ （右ペイン）                  │
│                 │                               │
│ • ルート追加    │ • タイトル編集                │
│ • 展開/折りたたみ│ • 内容編集                   │
│ • ドラッグ&ドロップ│ • 作成者編集               │
│ • 検索ハイライト│ • 作成日時表示               │
│                 │ • 更新日時表示               │
│                 │ • 保存ボタン                 │
│                 │ • 削除ボタン                 │
└─────────────────┴───────────────────────────────┘
```

## ヘッダーエリア

### バージョン情報表示
- **位置**: 画面上部中央
- **内容**: ビルド番号表示（例: "build #123"）
- **更新タイミング**: ページ読み込み時

## 左ペイン: ツリー表示エリア

### 全体説明
- ノードの階層構造をツリー形式で表示
- 展開/折りたたみ可能
- ドラッグ&ドロップで並び替え可能

### ルートノード追加ボタン
- **位置**: ツリーエリア上部
- **ラベル**: "ルートノード追加"
- **イベント**: クリック
- **動作**:
  - 新規ノード作成ダイアログ表示
  - タイトル入力後、ルートレベルにノード追加

### ツリーノード
- **構造**: 親子関係をインデントで表現
- **アイコン**: フォルダアイコン（展開/折りたたみ）
- **表示項目**:
  - ノードタイトル
  - 子ノード数表示（オプション）

### ノード操作
- **クリック**: 右ペインに詳細表示
- **ダブルクリック**: インライン編集モード
- **右クリック**: コンテキストメニュー（未実装）
- **ドラッグ**: ノード移動
- **ドロップ**: 親変更または順序変更

### 子ノード追加ボタン
- **位置**: 各ノードの隣
- **ラベル**: "+"
- **イベント**: クリック
- **動作**: 選択ノードの子として新規ノード作成

### 検索ハイライト
- **表示**: 検索結果のノードをハイライト
- **色**: 黄色背景
- **動作**: 検索時に該当ノードを自動展開

## 右ペイン: 詳細編集エリア

### タイトル編集フィールド
- **タイプ**: テキスト入力
- **プレースホルダー**: "タイトルを入力"
- **イベント**: 入力変更
- **動作**: リアルタイムでローカル状態更新

### 内容編集フィールド
- **タイプ**: テキストエリア
- **プレースホルダー**: "内容を入力"
- **属性**: rows="10"
- **イベント**: 入力変更
- **動作**: リアルタイムでローカル状態更新

### 作成者編集フィールド
- **タイプ**: テキスト入力
- **プレースホルダー**: "作成者名"
- **イベント**: 入力変更
- **動作**: リアルタイムでローカル状態更新

### 作成日時表示
- **フォーマット**: YYYY-MM-DD HH:mm:ss
- **位置**: 編集フィールド下
- **更新**: ノード選択時

### 更新日時表示
- **フォーマット**: YYYY-MM-DD HH:mm:ss
- **位置**: 作成日時下
- **更新**: 保存時

### 保存ボタン
- **ラベル**: "保存"
- **スタイル**: 緑色ボタン
- **イベント**: クリック
- **動作**:
  - 入力値を検証
  - API呼び出し（PUT /api/nodes/:id）
  - 成功時: ツリー更新、トースト表示
  - 失敗時: エラーメッセージ表示

### 削除ボタン
- **ラベル**: "削除"
- **スタイル**: 赤色ボタン
- **イベント**: クリック
- **動作**:
  - 確認ダイアログ表示
  - OK時: API呼び出し（DELETE /api/nodes/:id）
  - 成功時: ツリーから削除、右ペインクリア
  - 失敗時: エラーメッセージ表示

## 検索機能

### 検索バー
- **位置**: 画面上部（ヘッダー下）
- **プレースホルダー**: "検索..."
- **イベント**: 入力変更
- **動作**:
  - デバウンス処理（300ms）
  - API呼び出し（GET /api/search?q=キーワード）
  - 結果表示とハイライト

### クリアボタン
- **位置**: 検索バー内
- **ラベル**: "×"
- **イベント**: クリック
- **動作**: 検索クリア、ハイライト解除

## 通知システム

### トースト通知
- **位置**: 画面右下
- **タイプ**: success, error
- **表示時間**: 5秒
- **トリガー**:
  - 保存成功
  - 削除成功
  - APIエラー
  - ネットワークエラー

### ローディングオーバーレイ
- **表示条件**: API呼び出し中
- **内容**: スピナー + "処理中..." メッセージ

## レスポンシブ対応

### ブレークポイント
- **デスクトップ**: 1024px以上 - 2ペイン表示
- **タブレット**: 768px-1023px - 2ペイン（幅狭）
- **モバイル**: 767px以下 - 1ペイン（タブ切り替え）

### モバイル対応
- ツリーと詳細をタブで切り替え
- タッチ操作対応
- キーボード非表示時のレイアウト調整

## アクセシビリティ

### キーボード操作
- **Tab**: フォーカス移動
- **Enter**: ボタンクリック相当
- **Escape**: モーダル閉じる/編集キャンセル

### スクリーンリーダー
- **ARIAラベル**: 各要素に適切なラベル
- **ランドマーク**: main, navigation, complementary
- **ライブリージョン**: 動的コンテンツ更新通知

## エラー処理

### ネットワークエラー
- **表示**: トースト通知
- **メッセージ**: "ネットワークエラーが発生しました"

### サーバーエラー
- **表示**: トースト通知
- **メッセージ**: APIレスポンスのerrorフィールド

### バリデーションエラー
- **表示**: フィールド下にエラーメッセージ
- **タイミング**: 保存時チェック

## パフォーマンス考慮

### 遅延読み込み
- **ツリー展開**: 子ノードは展開時のみ読み込み
- **検索**: デバウンスでAPI呼び出し回数抑制

### 状態管理
- **ローカル状態**: 編集中の変更を一時保存
- **サーバー同期**: 保存時のみAPI呼び出し